define(["jquery","utils","config","clientAPI","layer","pagination","remodal"],function(e,t,n,a){var i=e("[data-remodal-id=changeLineModal]").remodal(),d=e("body"),o={init:function(){this.render(),this.bindEvents()},render:function(){this.initModal(),this.initEventBind(),this.fnGetList({},!0)},bindEvents:function(){this.onSearch()},initEventBind:function(){t.initDatePicker()},initModal:function(){d.on("click",".J_showChangeLine",function(){var t=e(this),n=t.parents("tr").find("td"),a=n.eq(4).text(),d=n.eq(2).text(),o=n.eq(3).text(),r=e(".changeLineModal .modalForm");r.find("input[name=orgName]").val(a),r.find("input[name=nickname]").val(d),r.find("input[name=phone]").val(o),i.open()}),e(document).on("closed",".remodal",function(t){e(this).find(".modalForm")[0].reset()})},onSearch:function(){var t=this;e(".J_search").on("click",function(){var n={page:1,startTime:e("#dateStart").val(),endTime:e("#dateEnd").val(),agetId:e("input[name=org]").val(),nickname:e("input[name=nickname]").val(),memberId:e("input[name=broker]").val(),phoneNum:e("input[name=phone]").val()};t.fnGetList(n,!0)})},onStopTrade:function(){d.on("click",".J_showStopTrade",function(){var t=e(this),n=t.parents("tr").attr("data-id");t.parents("tr").find("td").eq(2).text();layer.confirm("警告！停止交易后用户能正常登录，但是无法进行交易",{},function(){a.stopTrade({id:n},function(e){layer.msg("操作成功")}),layer.msg("操作成功")})})},fnGetList:function(t,i){var d=this,o=e(".data-container table");a.getClientList(t,function(a){if(console.log("获取客户管理列表 调用成功!"),"0"==a.list.length)return o.find("tbody").empty().html("<tr><td colspan='7'>暂无记录</td></tr>"),e(".pagination").hide(),!1;var r,l='<td><input type="checkbox"></td>';if(e.each(a.list,function(e,t){console.log(t.memberInfo);var a="<td>"+t.registerTime+"</td>",i="<td>"+t.nickname+"</td>",d="<td>"+t.phoneNum+"</td>",o="<td>"+(t.memberInfo?t.memberInfo.name:"")+"</td>",s="<td>"+(t.ageInfo?t.ageInfo.nickname:"")+"</td>",m="<td>"+n.tradeStatus[t.status]+"</td>",c="<td><a class='text-blue' href='/clientManage/clientListView/buyLog?uid="+t.uid+"'> 查看 </a> </td>";r+='<tr class="fadeIn animated" data-id="'+t.uid+'">'+l+a+i+d+o+s+m+c+"</tr>"}),o.find("tbody").empty().html(r),i){var s=a.totalPages;s>0&&(console.log("页数："+s),e(".pagination").show().html("").createPage({pageCount:s,current:1,backFn:function(e){var n=t;n.page=e,d.fnGetList(t)}}))}});var r={totalPages:4,pageNum:5,page:1,list:[{uid:"3",phoneNum:"18657195470",nickname:"从VB分",type:"0",headUrl:"",passwd:"d2337e370831e755254797c9a2d3139aa9a53bb977ad7ad27e213d30eccade2d",cashLv:"0",registerTime:"2017-03-20 11:53:02",registerStatus:"0",gender:"0",lastLoginTime:"2017-04-11 13:50:01",lastLoginIp:"60.186.229.22",memberId:"123",agentId:"1",recommend:null,status:"0",memberInfo:{memberId:"123",name:"123",type:"0",superMemberid:"1"},ageInfo:{code:"1",nickname:"123",type:"0",memberid:"123",phone:"123",status:"1"}},{uid:"4",phoneNum:"18657195471",nickname:"cbe6",type:"0",headUrl:"",passwd:"1960c2bebf7ce4171f9b0a189a9bf53bdea9c9646289931e712b6e6a9ac6e85a",cashLv:"0",registerTime:"2017-03-20 11:59:22",registerStatus:"0",gender:"0",lastLoginTime:"0000-00-00 00:00:00",lastLoginIp:"",memberId:null,agentId:null,recommend:null,status:"0",memberInfo:null,ageInfo:null},{uid:"5",phoneNum:"18668169052",nickname:"越快越好",type:"0",headUrl:"",passwd:"4bcf73028a526f5ae6899759ab332c3d3b173855bef3b22b19224cd5233d39c0",cashLv:"0",registerTime:"2017-03-20 12:59:02",registerStatus:"0",gender:"0",lastLoginTime:"2017-04-11 14:25:29",lastLoginIp:"60.186.229.22",memberId:null,agentId:null,recommend:null,status:"0",memberInfo:null,ageInfo:null},{uid:"6",phoneNum:"13388128876",nickname:"出vdf",type:"0",headUrl:"",passwd:"e15a41f7766771ebb9b3cb15f1d6854b7dffe37ba4c51590e858459ded503106",cashLv:"0",registerTime:"2017-03-20 15:50:44",registerStatus:"0",gender:"0",lastLoginTime:"2017-03-20 15:50:44",lastLoginIp:"60.176.185.231",memberId:null,agentId:null,recommend:null,status:"0",memberInfo:null,ageInfo:null},{uid:"7",phoneNum:"18657195476",nickname:"按时",type:"0",headUrl:"",passwd:"57af5465e2ff85ef84f396cd41d4182a0aec94d1b55b5f489b662cb07ece44cd",cashLv:"0",registerTime:"2017-03-20 16:03:02",registerStatus:"0",gender:"0",lastLoginTime:"2017-03-20 17:04:43",lastLoginIp:"60.176.185.231",memberId:null,agentId:null,recommend:null,status:"0",memberInfo:null,ageInfo:null}]};if(console.log("获取客户管理列表 调用成功!"),"0"==r.list.length)return o.find("tbody").empty().html("<tr><td colspan='7'>暂无记录</td></tr>"),e(".pagination").hide(),!1;var l,s='<td><input type="checkbox"></td>';if(e.each(r.list,function(e,t){console.log(t.memberInfo);var a="<td>"+t.registerTime+"</td>",i="<td>"+t.nickname+"</td>",d="<td>"+t.phoneNum+"</td>",o="<td>"+(t.memberInfo?t.memberInfo.name:"")+"</td>",r="<td>"+(t.ageInfo?t.ageInfo.nickname:"")+"</td>",m="<td>"+n.tradeStatus[t.status]+"</td>",c="<td><a class='text-blue' href='/clientManage/clientListView/wpcLog?uid="+t.uid+"'> 查看 </a> </td>";l+='<tr class="fadeIn animated" data-id="'+t.uid+'">'+s+a+i+d+o+r+m+c+"</tr>"}),o.find("tbody").empty().html(l),i){var m=r.totalPages;m>0&&(console.log("页数："+m),e(".pagination").show().html("").createPage({pageCount:m,current:1,backFn:function(e){var n=t;n.page=e,d.fnGetList(t)}}))}}};o.init()});